"use strict";var e=require("react/jsx-runtime"),t=require("react"),r=Object.prototype.hasOwnProperty;function i(e,t,r){for(r of e.keys())if(n(r,t))return r}function n(e,t){var o,a,h;if(e===t)return!0;if(e&&t&&(o=e.constructor)===t.constructor){if(o===Date)return e.getTime()===t.getTime();if(o===RegExp)return e.toString()===t.toString();if(o===Array){if((a=e.length)===t.length)for(;a--&&n(e[a],t[a]););return-1===a}if(o===Set){if(e.size!==t.size)return!1;for(a of e){if((h=a)&&"object"==typeof h&&!(h=i(t,h)))return!1;if(!t.has(h))return!1}return!0}if(o===Map){if(e.size!==t.size)return!1;for(a of e){if((h=a[0])&&"object"==typeof h&&!(h=i(t,h)))return!1;if(!n(a[1],t.get(h)))return!1}return!0}if(o===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(o===DataView){if((a=e.byteLength)===t.byteLength)for(;a--&&e.getInt8(a)===t.getInt8(a););return-1===a}if(ArrayBuffer.isView(e)){if((a=e.byteLength)===t.byteLength)for(;a--&&e[a]===t[a];);return-1===a}if(!o||"object"==typeof e){for(o in a=0,e){if(r.call(e,o)&&++a&&!r.call(t,o))return!1;if(!(o in t)||!n(e[o],t[o]))return!1}return Object.keys(t).length===a}}return e!=e&&t!=t}var o=1e3,a=function(e,r,i,a){var h,u,s,c,f=t.useState({headerHeight:0,footerHeight:0,showFromIndex:0,showToIndex:e.length-1}),g=f[0],d=f[1],l=t.useRef(0);return h=function(){var t=function(){if(i.current&&a.current){var t=function(e,t,r,i){var n=0,a=0,h=0,u=0,s=e.length-1,c=r.getBoundingClientRect(),f=i.getBoundingClientRect().top-c.top,g=r.clientHeight,d=-1e3,l=g+o;return e.forEach((function(r,i){var o=r.height,c=f+n;if(d>c+o)a+=(0===i?0:t)+o,u=i+1;else if(l>c)s=i;else{var g=i===e.length-1;h+=o+(g?0:t)}n+=o+t})),{headerHeight:a,footerHeight:h,showFromIndex:u,showToIndex:s}}(e,r,i.current,a.current);d(t),l.current=i.current.scrollTop}},n=function(){if(i.current){var e=l.current,r=i.current.scrollTop;Math.abs(e-r)>o&&t()}};t();var h=i.current;return null==h||h.addEventListener("scroll",n),function(){null==h||h.removeEventListener("scroll",n)}},u=[e.map((function(e){return e.height})),r,i,a],s=t.useRef(!0),c=t.useRef(u),t.useEffect(h,[function(e){var t=c.current;return c.current=e,n(e,t)||(s.current=!s.current),s.current}(u)]),g},h=function(t){var r=t.items,i=t.itemRenderer,n=t.gap,o=void 0===n?0:n,h=t.scrollRef,u=t.containerRef,s=a(r,o,h,u),c=s.headerHeight,f=s.footerHeight,g=s.showFromIndex,d=s.showToIndex;return e.jsxs(e.Fragment,{children:[c?e.jsx("div",{style:{height:c}}):null,r.map((function(e,t){return t<g||t>d?null:i({item:e,index:t})})),f?e.jsx("div",{style:{height:f}}):null]})};"function"==typeof SuppressedError&&SuppressedError;var u=function(e){return e.width/e.height},s=function(e,t,r){var i=e;return"number"==typeof r&&(i=Math.min(i,r)),i=Math.max(i,t)},c=function(e){var r,i,o,a;return r=function(){return new f(e).fillRows()},i=[e],o=t.useRef(!0),a=t.useRef(i),t.useMemo(r,[function(e){var t=a.current;return a.current=e,n(e,t)||(o.current=!o.current),o.current}(i)])},f=function(){function e(e){var t=e.items,r=e.containerWidth,i=e.gap,n=e.rowHeightRange,o=e.itemRatioRange,a=e.maxColumns,h=e.enableCrop,u=e.preserveAspectRatio;if(this.rows=[],t.some((function(e){return void 0===e.width||void 0===e.height})))throw new Error("Items should have 'width' and 'height' properties");if(this._items=t,r<0)throw new Error("Container width should be positive");this.containerWidth=r;if(i&&i<0)throw new Error("Gap should be positive");this.gap=i||0;if(n){if(n.min<0||n.max<0)throw new Error("Row height range should be positive");if(n.max<n.min)throw new Error("Row height range minimum should be less than maximum")}this.rowHeightRange=n||{min:240,max:340};if(o){if(o.min<0||o.max<0)throw new Error("Item ratio range should be positive");if(o.max<o.min)throw new Error("Item ratio range minimum shold be less than maximum")}if(this.itemRatioRange=!u&&o?o:{min:0,max:1e6},void 0!==a&&a<=0)throw new Error("maxColumns should be greater than 0");this.maxColumns=a,this.enableCrop=h,this.preserveAspectRatio=u}return e.prototype.addRow=function(e){this.rows.push(e)},e.prototype.fillRows=function(){var e=this;return this._items.forEach((function(t,r){var i=e.rows[e.rows.length-1];if(!i){var n=new g(e);e.addRow(n),i=n}0===i.columns?i.addItem(t,r):i.canAddItem(t)?i.addItem(t,r):(i.adjust(),(n=new g(e)).addItem(t,r),e.addRow(n))})),this.rows},e}(),g=function(){function e(e){this.items=[],this._grid=e}return Object.defineProperty(e.prototype,"isLast",{get:function(){return this._grid.rows[this._grid.rows.length-1]===this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemRatioRange",{get:function(){return this._grid.itemRatioRange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._grid.containerWidth-Math.max(this.columns-1,0)*this._grid.gap},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 0===this.columns?0:this.width/this.ratio},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ratio",{get:function(){var e=this.items.map((function(e){return e.ratio})).reduce((function(e,t){return e+t}),0);return this.isLast?s(e,this.ratioRange.min):e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ratioRange",{get:function(){var e=this.width;return{min:e/this._grid.rowHeightRange.max,max:e/this._grid.rowHeightRange.min}},enumerable:!1,configurable:!0}),e.prototype.addItem=function(e,t){this.items.push(new d(e,t,this))},e.prototype.canAddItem=function(e){var t=this.clone(this._grid);t.addItem(e,0);var r=t.ratioRange.max,i=t.ratio<=r,n=!this._grid.maxColumns||this._grid.maxColumns>=t.columns;return i&&n},e.prototype.clone=function(t){var r=new e(t);return r.items=this.items.map((function(e){return e.clone(r)})),r},e.prototype.adjust=function(){if(!this._grid.preserveAspectRatio){var e=this.ratio,t=this.ratioRange;if(e<t.min){var r=t.min-e,i=function(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}([],this.items,!0);i.sort((function(e,t){return e.ratio-t.ratio}));var n=i[0];n&&(n.ratio+=r)}else if(e>t.max){
//!IMPORTANT
var o=(r=t.max-e)/this.columns;this.items.forEach((function(e){e.ratio+=o}))}}},e}(),d=function(){function e(e,t,r){this.content=e,this.idx=t,this._row=r,this._ratio=s(u(e),this.ratioRange.min,this.ratioRange.max)}return Object.defineProperty(e.prototype,"ratioRange",{get:function(){return this._row.itemRatioRange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ratio",{get:function(){return this._ratio},set:function(e){this._ratio=s(e,this.ratioRange.min,this.ratioRange.max)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalRatio",{get:function(){return u(this.content)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var e=this._row.height;return{width:this.ratio*e,height:e}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cropBox",{get:function(){return e=this.size,t=this.content,r=u(e),i=u(t),n={width:t.width,height:t.height,left:0,top:0},r>i?(n.width=e.width,n.height=e.width/i):(n.width=e.height*i,n.height=e.height),n.left=-Math.abs(e.width-n.width)/2,n.top=-Math.abs(e.height-n.height)/2,n;var e,t,r,i,n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fitBox",{get:function(){return e=this.size,t=this.content,r=u(e),i=u(t),n={width:t.width,height:t.height,left:0,top:0},r<i?(n.width=e.width,n.height=e.width/i):(n.width=e.height*i,n.height=e.height),n.left=Math.abs(e.width-n.width)/2,n.top=Math.abs(e.height-n.height)/2,n;var e,t,r,i,n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aspectRatioPreserved",{get:function(){return this.originalRatio===this.ratio},enumerable:!1,configurable:!0}),e.prototype.clone=function(t){return new e(this.content,this.idx,t)},e}();exports.Gallery=function(r){var i=r.items,n=r.itemRenderer,o=r.keyExtractor,a=r.gap,u=void 0===a?0:a,s=r.gapX,f=r.gapY,g=r.rowHeightRange,d=r.itemRatioRange,l=r.maxColumns,m=r.preserveAspectRatio,p=r.scrollRef,w=function(){var e=t.useRef(null),r=t.useState({width:0,height:0}),i=r[0],n=r[1];return t.useLayoutEffect((function(){var t=function(){var t=e.current;if(t){var r=t.getBoundingClientRect();n((function(e){return e.width===r.width&&e.height===r.height?e:{width:r.width,height:r.height}}))}};t();var r=new MutationObserver(t);return e.current&&r.observe(e.current,{childList:!0,subtree:!0,attributes:!0}),window.addEventListener("resize",t),function(){r.disconnect(),window.removeEventListener("resize",t)}}),[]),{measureRef:e,size:i}}(),v=w.measureRef,b=w.size.width||500,y=void 0!==s?s:u,R=void 0!==f?f:u,x=c({items:i,containerWidth:b,gap:y,rowHeightRange:g,itemRatioRange:d,maxColumns:l,preserveAspectRatio:m}),j=function(t,r){var i={display:"flex",flexDirection:"row",gap:y,height:t.height};return e.jsx("div",{style:i,children:t.items.map((function(t){var r=t.size,i=o?o(t.content,t.idx):t.idx;return e.jsx("div",{style:r,children:n({index:t.idx,item:t.content,size:t.size,cropBox:t.cropBox,fitBox:t.fitBox,aspectRatioPreserved:t.aspectRatioPreserved})},i)}))},r)},E={display:"flex",flexDirection:"column",width:"100%",gap:R},_=!!p;return e.jsx("div",{ref:v,style:E,children:_?e.jsx(h,{scrollRef:p,items:x,gap:R,containerRef:v,itemRenderer:function(e){var t=e.item,r=e.index;return j(t,r)}}):e.jsx(e.Fragment,{children:x.map(j)})})},exports.Virtualizer=h;
//# sourceMappingURL=index.js.map
