"use strict";var t=require("react/jsx-runtime"),e=require("react"),r=Object.prototype.hasOwnProperty;function i(t,e,r){for(r of t.keys())if(n(r,e))return r}function n(t,e){var o,a,h;if(t===e)return!0;if(t&&e&&(o=t.constructor)===e.constructor){if(o===Date)return t.getTime()===e.getTime();if(o===RegExp)return t.toString()===e.toString();if(o===Array){if((a=t.length)===e.length)for(;a--&&n(t[a],e[a]););return-1===a}if(o===Set){if(t.size!==e.size)return!1;for(a of t){if((h=a)&&"object"==typeof h&&!(h=i(e,h)))return!1;if(!e.has(h))return!1}return!0}if(o===Map){if(t.size!==e.size)return!1;for(a of t){if((h=a[0])&&"object"==typeof h&&!(h=i(e,h)))return!1;if(!n(a[1],e.get(h)))return!1}return!0}if(o===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(o===DataView){if((a=t.byteLength)===e.byteLength)for(;a--&&t.getInt8(a)===e.getInt8(a););return-1===a}if(ArrayBuffer.isView(t)){if((a=t.byteLength)===e.byteLength)for(;a--&&t[a]===e[a];);return-1===a}if(!o||"object"==typeof t){for(o in a=0,t){if(r.call(t,o)&&++a&&!r.call(e,o))return!1;if(!(o in e)||!n(t[o],e[o]))return!1}return Object.keys(e).length===a}}return t!=t&&e!=e}var o=function(t,r,i,o){var a,h,u,s,c=e.useState({headerHeight:0,footerHeight:0,showFromIndex:0,showToIndex:t.length-1}),f=c[0],g=c[1];return a=function(){var e=function(){if(i.current&&o.current){var e=function(t,e,r,i){var n=0,o=0,a=0,h=0,u=t.length-1,s=r.getBoundingClientRect(),c=i.getBoundingClientRect().top-s.top,f=r.clientHeight,g=-500,d=f+500;return t.forEach((function(t,r){var i=t.height+e,s=c+n;g>s+i?(o+=i,h=r+1):d>s?u=r:a+=i,n+=i})),{headerHeight:o,footerHeight:a,showFromIndex:h,showToIndex:u}}(t,r,i.current,o.current);g(e)}};e();var n=i.current;return null==n||n.addEventListener("scroll",e),function(){null==n||n.removeEventListener("scroll",e)}},h=[t.map((function(t){return t.height})),r,i,o],u=e.useRef(!0),s=e.useRef(h),e.useEffect(a,[function(t){var e=s.current;return s.current=t,n(t,e)||(u.current=!u.current),u.current}(h)]),f},a=function(e){var r=e.items,i=e.itemRenderer,n=e.gap,a=void 0===n?0:n,h=e.scrollRef,u=e.containerRef,s=o(r,a,h,u),c=s.headerHeight,f=s.footerHeight,g=s.showFromIndex,d=s.showToIndex;return t.jsxs(t.Fragment,{children:[c?t.jsx("div",{style:{height:c}}):null,r.map((function(t,e){return e<g||e>d?null:i({item:t,index:e})})),f?t.jsx("div",{style:{height:f}}):null]})};"function"==typeof SuppressedError&&SuppressedError;var h=function(t){return t.width/t.height},u=function(t,e,r){var i=t;return"number"==typeof r&&(i=Math.min(i,r)),i=Math.max(i,e)},s=function(t){var r,i,o,a;return r=function(){return new c(t).fillRows()},i=[t],o=e.useRef(!0),a=e.useRef(i),e.useMemo(r,[function(t){var e=a.current;return a.current=t,n(t,e)||(o.current=!o.current),o.current}(i)])},c=function(){function t(t){var e=t.items,r=t.containerWidth,i=t.gap,n=t.rowHeightRange,o=t.itemRatioRange,a=t.maxColumns,h=t.enableCrop,u=t.preserveAspectRatio;if(this.rows=[],e.some((function(t){return void 0===t.width||void 0===t.height})))throw new Error("Items should have 'width' and 'height' properties");if(this._items=e,r<0)throw new Error("Container width should be positive");this.containerWidth=r;if(i&&i<0)throw new Error("Gap should be positive");this.gap=i||0;if(n){if(n.min<0||n.max<0)throw new Error("Row height range should be positive");if(n.max<n.min)throw new Error("Row height range minimum should be less than maximum")}this.rowHeightRange=n||{min:240,max:340};if(o){if(o.min<0||o.max<0)throw new Error("Item ratio range should be positive");if(o.max<o.min)throw new Error("Item ratio range minimum shold be less than maximum")}if(this.itemRatioRange=!u&&o?o:{min:0,max:1e6},void 0!==a&&a<=0)throw new Error("maxColumns should be greater than 0");this.maxColumns=a,this.enableCrop=h,this.preserveAspectRatio=u}return t.prototype.addRow=function(t){this.rows.push(t)},t.prototype.fillRows=function(){var t=this;return this._items.forEach((function(e){var r=t.rows[t.rows.length-1];if(!r){var i=new f(t);t.addRow(i),r=i}0===r.columns?r.addItem(e):r.canAddItem(e)?r.addItem(e):(r.adjust(),(i=new f(t)).addItem(e),t.addRow(i))})),this.rows},t}(),f=function(){function t(t){this.items=[],this._grid=t}return Object.defineProperty(t.prototype,"isLast",{get:function(){return this._grid.rows[this._grid.rows.length-1]===this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemRatioRange",{get:function(){return this._grid.itemRatioRange},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._grid.containerWidth-Math.max(this.columns-1,0)*this._grid.gap},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return 0===this.columns?0:this.width/this.ratio},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ratio",{get:function(){var t=this.items.map((function(t){return t.ratio})).reduce((function(t,e){return t+e}),0);return this.isLast?u(t,this.ratioRange.min):t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ratioRange",{get:function(){var t=this.width;return{min:t/this._grid.rowHeightRange.max,max:t/this._grid.rowHeightRange.min}},enumerable:!1,configurable:!0}),t.prototype.addItem=function(t){this.items.push(new g(t,this))},t.prototype.canAddItem=function(t){var e=this.clone(this._grid);e.addItem(t);var r=e.ratioRange.max,i=e.ratio<=r,n=!this._grid.maxColumns||this._grid.maxColumns>=e.columns;return i&&n},t.prototype.clone=function(e){var r=new t(e);return r.items=this.items.map((function(t){return t.clone(r)})),r},t.prototype.adjust=function(){if(!this._grid.preserveAspectRatio){var t=this.ratio,e=this.ratioRange;if(t<e.min){var r=e.min-t,i=function(t,e,r){if(r||2===arguments.length)for(var i,n=0,o=e.length;n<o;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}([],this.items,!0);i.sort((function(t,e){return t.ratio-e.ratio}));var n=i[0];n&&(n.ratio+=r)}else if(t>e.max){
//!IMPORTANT
var o=(r=e.max-t)/this.columns;this.items.forEach((function(t){t.ratio+=o}))}}},t}(),g=function(){function t(t,e){this.content=t,this._row=e,this._ratio=u(h(t),this.ratioRange.min,this.ratioRange.max)}return Object.defineProperty(t.prototype,"ratioRange",{get:function(){return this._row.itemRatioRange},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ratio",{get:function(){return this._ratio},set:function(t){this._ratio=u(t,this.ratioRange.min,this.ratioRange.max)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalRatio",{get:function(){return h(this.content)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var t=this._row.height;return{width:this.ratio*t,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cropBox",{get:function(){return t=this.size,e=this.content,r=h(t),i=h(e),n={width:e.width,height:e.height,left:0,top:0},r>i?(n.width=t.width,n.height=t.width/i):(n.width=t.height*i,n.height=t.height),n.left=-Math.abs(t.width-n.width)/2,n.top=-Math.abs(t.height-n.height)/2,n;var t,e,r,i,n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fitBox",{get:function(){return t=this.size,e=this.content,r=h(t),i=h(e),n={width:e.width,height:e.height,left:0,top:0},r<i?(n.width=t.width,n.height=t.width/i):(n.width=t.height*i,n.height=t.height),n.left=Math.abs(t.width-n.width)/2,n.top=Math.abs(t.height-n.height)/2,n;var t,e,r,i,n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"aspectRatioPreserved",{get:function(){return this.originalRatio===this.ratio},enumerable:!1,configurable:!0}),t.prototype.clone=function(e){return new t(this.content,e)},t}();exports.Gallery=function(r){var i=r.items,n=r.itemRenderer,o=r.keyExtractor,h=r.gap,u=void 0===h?0:h,c=r.rowHeightRange,f=r.itemRatioRange,g=r.maxColumns,d=r.preserveAspectRatio,l=r.scrollRef,m=function(){var t=e.useRef(null),r=e.useState({width:0,height:0}),i=r[0],n=r[1];return e.useLayoutEffect((function(){var e=function(){var e=t.current;if(e){var r=e.getBoundingClientRect();n((function(t){return t.width===r.width&&t.height===r.height?t:{width:r.width,height:r.height}}))}};e();var r=new MutationObserver(e);return t.current&&r.observe(t.current,{childList:!0,subtree:!0,attributes:!0}),window.addEventListener("resize",e),function(){r.disconnect(),window.removeEventListener("resize",e)}}),[]),{measureRef:t,size:i}}(),p=m.measureRef,w=m.size.width||500,v=s({items:i,containerWidth:w,gap:u,rowHeightRange:c,itemRatioRange:f,maxColumns:g,preserveAspectRatio:d}),b=function(e,r){var i={display:"flex",flexDirection:"row",gap:u,height:e.height};return t.jsx("div",{style:i,children:e.items.map((function(e,r){var i=e.size,a=o?o(e.content,r):r;return t.jsx("div",{style:i,children:n({index:r,item:e.content,size:e.size,cropBox:e.cropBox,fitBox:e.fitBox,aspectRatioPreserved:e.aspectRatioPreserved})},a)}))},r)},y={display:"flex",flexDirection:"column",width:"100%",gap:u},R=!!l;return t.jsx("div",{ref:p,style:y,children:R?t.jsx(a,{scrollRef:l,items:v,gap:u,containerRef:p,itemRenderer:function(t){var e=t.item,r=t.index;return b(e,r)}}):t.jsx(t.Fragment,{children:v.map(b)})})},exports.Virtualizer=a;
//# sourceMappingURL=index.js.map
